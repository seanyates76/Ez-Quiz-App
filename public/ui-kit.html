<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>EZ Quiz UI Kit</title>
  <link rel="stylesheet" href="./styles.css">
  <style>
    .ui-shell {
      display: grid;
      gap: var(--sp-8);
    }

    .ui-toolbar {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: var(--sp-4);
      justify-content: space-between;
    }

    .ui-toolbar__group {
      display: inline-flex;
      align-items: center;
      gap: var(--sp-3);
    }

    .section {
      display: grid;
      gap: var(--sp-5);
    }

    .section__title {
      font-size: var(--fz-4);
      line-height: var(--lh-1);
      margin: 0;
    }

    .section__subtitle {
      margin: 0;
      font-size: var(--fz-1);
      color: var(--c-text-muted);
    }

    .component-grid {
      display: grid;
      gap: var(--sp-6);
    }

    @media (min-width: 720px) {
      .component-grid {
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      }
    }

    .grid-helper {
      position: relative;
      padding: var(--sp-6);
      border-radius: var(--r-2);
      border: 1px dashed var(--c-border);
      background:
        repeating-linear-gradient(
          90deg,
          rgba(122, 91, 255, 0.12) 0,
          rgba(122, 91, 255, 0.12) 1px,
          transparent 1px,
          transparent 80px
        ),
        var(--c-surface);
    }

    .grid-helper[data-grid="hidden"] {
      background: var(--c-surface);
    }

    .grid-helper__label {
      display: inline-flex;
      align-items: center;
      gap: var(--sp-2);
      padding: 2px var(--sp-3);
      border-radius: var(--r-round);
      background: var(--c-surface-2);
      border: 1px solid var(--c-border);
      font-size: var(--fz-1);
      margin-bottom: var(--sp-4);
    }

    .stack {
      display: grid;
      gap: var(--sp-3);
    }

    .pill-group {
      display: inline-flex;
      flex-wrap: wrap;
      gap: var(--sp-2);
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }
  </style>
</head>
<body>
  <header class="container ui-shell">
    <div class="ui-toolbar" role="banner">
      <div class="ui-toolbar__group">
        <div>
          <h1 class="section__title" style="font-size:var(--fz-5); margin-bottom:var(--sp-2);">Cohesion UI Kit</h1>
          <p class="section__subtitle">Phase 1 tokens, live theme toggle, modal sample, and grid helpers.</p>
        </div>
      </div>
      <div class="ui-toolbar__group">
        <button id="themeToggle" class="btn btn--primary" type="button" aria-pressed="false">
          Switch to light theme
        </button>
        <span id="themeStatus" class="pill" role="status" aria-live="polite">Theme: dark</span>
      </div>
    </div>
    <div class="ui-toolbar" role="region" aria-label="Utility actions">
      <div class="ui-toolbar__group">
        <button id="openModal" class="btn" type="button" aria-haspopup="dialog" aria-controls="uiModal">
          Open modal demo
        </button>
      </div>
      <div class="ui-toolbar__group">
        <span class="section__subtitle">Grid helpers</span>
        <button id="toggleGrid" class="btn btn--ghost" type="button" aria-pressed="true">
          Hide grid overlay
        </button>
      </div>
    </div>
  </header>

  <main class="container ui-shell" id="main-content">
    <section class="section" aria-labelledby="tokens-heading">
      <div>
        <h2 id="tokens-heading" class="section__title">Core elements</h2>
        <p class="section__subtitle">Base button, surface card, and control states using Phase 1 tokens.</p>
      </div>
      <div class="component-grid">
        <article class="card">
          <header class="card__header">
            <h3 class="section__title" style="font-size:var(--fz-3);">Buttons</h3>
          </header>
          <div class="card__body stack">
            <div class="stack">
              <div class="pill-group" aria-label="Button variations">
                <span class="pill">Default</span>
                <span class="pill">Primary</span>
                <span class="pill">Ghost</span>
              </div>
              <div class="stack" role="group" aria-label="Button samples">
                <button type="button" class="btn">Secondary action</button>
                <button type="button" class="btn btn--primary">Primary action</button>
                <button type="button" class="btn btn--ghost">Ghost action</button>
                <button type="button" class="btn" disabled aria-disabled="true">Disabled</button>
              </div>
            </div>
          </div>
        </article>

        <article class="card">
          <header class="card__header">
            <h3 class="section__title" style="font-size:var(--fz-3);">Form controls</h3>
          </header>
          <div class="card__body stack">
            <label class="stack">
              <span class="section__subtitle" style="color:var(--c-text);">Text input</span>
              <input type="text" class="input" placeholder="Placeholder text">
            </label>
            <label class="stack">
              <span class="section__subtitle" style="color:var(--c-text);">Select</span>
              <select>
                <option>Option one</option>
                <option>Option two</option>
                <option>Option three</option>
              </select>
            </label>
            <label class="stack">
              <span class="section__subtitle" style="color:var(--c-text);">Textarea</span>
              <textarea rows="3" placeholder="Textarea sample"></textarea>
            </label>
          </div>
        </article>

        <article class="card">
          <header class="card__header">
            <h3 class="section__title" style="font-size:var(--fz-3);">Palette tokens</h3>
          </header>
          <div class="card__body stack" aria-label="Palette tokens">
            <div class="pill-group">
              <span class="pill" style="background:var(--c-accent); color:var(--c-text-inverse);">Accent</span>
              <span class="pill" style="background:var(--c-accent-2); color:var(--c-text-inverse);">Accent 2</span>
              <span class="pill" style="background:var(--c-success); color:var(--c-text-inverse);">Success</span>
              <span class="pill" style="background:var(--c-danger); color:var(--c-text-inverse);">Danger</span>
            </div>
            <p class="section__subtitle">Tokens display contextual surfaces when theme changes.</p>
          </div>
        </article>
      </div>
    </section>

    <section class="section" aria-labelledby="grid-heading">
      <div>
        <h2 id="grid-heading" class="section__title">Grid helper</h2>
        <p class="section__subtitle">Preview a 12-column responsive grid using inline helpers.</p>
      </div>
      <div class="grid-helper" data-grid="visible" id="gridHelper">
        <span class="grid-helper__label" aria-hidden="true">12-column overlay</span>
        <div class="stack" role="list">
          <div class="card" role="listitem">
            <div class="card__body">
              <p class="section__subtitle" style="color:var(--c-text);">Resize the viewport to validate column behavior.</p>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <div class="modal" id="uiModal" role="dialog" aria-modal="true" aria-labelledby="uiModalTitle" aria-describedby="uiModalDescription">
    <div class="modal__backdrop" data-dismiss="modal"></div>
    <div class="modal__dialog">
      <div class="stack" style="gap:var(--sp-4);">
        <header class="stack" style="gap:var(--sp-2);">
          <h2 id="uiModalTitle" class="section__title" style="font-size:var(--fz-4); margin:0;">Modal sample</h2>
          <p id="uiModalDescription" class="section__subtitle">Accessible dialog with Escape and backdrop close.</p>
        </header>
        <p class="section__subtitle" style="color:var(--c-text);">
          This modal demonstrates interaction within the Phase 1 token system. Use the keyboard to ensure cycling focus and Esc to exit.
        </p>
        <div class="ui-toolbar__group" style="justify-content:flex-end;">
          <button id="closeModal" class="btn btn--primary" type="button">Close modal</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    (function () {
      const root = document.documentElement;
      const themeToggle = document.getElementById('themeToggle');
      const themeStatus = document.getElementById('themeStatus');
      const openModalButton = document.getElementById('openModal');
      const closeModalButton = document.getElementById('closeModal');
      const modal = document.getElementById('uiModal');
      const modalBackdrop = modal.querySelector('[data-dismiss]');
      const gridToggle = document.getElementById('toggleGrid');
      const gridHelper = document.getElementById('gridHelper');

      let lastFocusTarget = null;

      const setTheme = (theme) => {
        const isLight = theme === 'light';
        root.classList.toggle('light', isLight);
        themeToggle.setAttribute('aria-pressed', String(isLight));
        themeToggle.textContent = isLight ? 'Switch to dark theme' : 'Switch to light theme';
        themeStatus.textContent = 'Theme: ' + theme;
      };

      const currentTheme = () => (root.classList.contains('light') ? 'light' : 'dark');

      themeToggle.addEventListener('click', () => {
        const next = currentTheme() === 'dark' ? 'light' : 'dark';
        setTheme(next);
      });

      const getFocusableElements = () => {
        return Array.from(
          modal.querySelectorAll('a[href], button:not([disabled]), [tabindex]:not([tabindex="-1"])')
        );
      };

      const openModal = () => {
        if (modal.classList.contains('is-open')) return;
        lastFocusTarget = document.activeElement;
        modal.classList.add('is-open');
        const focusable = getFocusableElements();
        if (focusable.length) {
          focusable[0].focus();
        }
      };

      const closeModal = () => {
        if (!modal.classList.contains('is-open')) return;
        modal.classList.remove('is-open');
        if (lastFocusTarget && typeof lastFocusTarget.focus === 'function') {
          lastFocusTarget.focus();
        }
      };

      openModalButton.addEventListener('click', openModal);
      closeModalButton.addEventListener('click', closeModal);
      modalBackdrop.addEventListener('click', closeModal);

      document.addEventListener('keydown', (event) => {
        if (!modal.classList.contains('is-open')) {
          return;
        }

        if (event.key === 'Escape') {
          event.preventDefault();
          closeModal();
          return;
        }

        if (event.key === 'Tab') {
          const focusable = getFocusableElements();
          if (focusable.length === 0) {
            event.preventDefault();
            return;
          }
          const first = focusable[0];
          const last = focusable[focusable.length - 1];
          if (event.shiftKey && document.activeElement === first) {
            event.preventDefault();
            last.focus();
          } else if (!event.shiftKey && document.activeElement === last) {
            event.preventDefault();
            first.focus();
          }
        }
      });

      gridToggle.addEventListener('click', () => {
        const isVisible = gridHelper.getAttribute('data-grid') === 'visible';
        gridHelper.setAttribute('data-grid', isVisible ? 'hidden' : 'visible');
        gridToggle.setAttribute('aria-pressed', String(!isVisible));
        gridToggle.textContent = isVisible ? 'Show grid overlay' : 'Hide grid overlay';
      });

      // initialize default state
      setTheme('dark');
    })();
  </script>
</body>
</html>
